<!--
 * @file Account.razer
 * @author Thomas Tran Dang (thomasdang92@gmail.com) and Madelyn Little (mlittle6@atu.edu)
 * @brief This file provides the code for the account portion of the web application.
 * @version 0.12
 * @date 2023-12-09
 *
 * @copyright Copyright (c) 2023
 *
-->
@page "/account"
<PageTitle>Account</PageTitle>
<link href="css/Account.css" rel="stylesheet" />
@inject IJSRuntime JSRuntime

<body>
    <h1 class="welcome">Profile Page</h1>

     <div class="profile-menu">
    <div class="user-info-container"> 
        <div class="icon-container">
            <img src="\images\account-icon.svg" alt="account avatar" class="account">
        </div>

        <div class="wow"> 
            <p id="emaildiv"></p>
            <p id="firstnamediv"></p>
            <p id="lastnamediv"></p>
        </div>
        <div class="user-actions"> 
                <button class="share-profile-button">Edit Profile Info</button>
                <button class="create-build-button">Create Build</button>
            </div>
    </div>

    <div id="saved-builds-container">
    <div class="saved-build-entry">
        <img src="\images\case.png" alt="Build Icon" class="build-icon">
        <span class="build-name">PC build Name</span>
        <span class="build-price">$3,000</span>
        <button class="edit-build">Edit</button>
        <button class="delete-build">Delete</button>
    </div>
    <!-- Repeat the above div for each saved build entry -->
    <div class="saved-build-entry">
        <img src="\images\case.png" alt="Build Icon" class="build-icon">
        <span class="build-name">PC build Name</span>
        <span class="build-price">$3,000</span>
        <button class="edit-build">Edit</button>
        <button class="delete-build">Delete</button>
    </div>
    <div class="saved-build-entry">
        <img src="\images\case.png" alt="Build Icon" class="build-icon">
        <span class="build-name">PC build Name</span>
        <span class="build-price">$3,000</span>
        <button class="edit-build">Edit</button>
        <button class="delete-build">Delete</button>
    </div>
</div>
</div>

    <script defer>
        document.addEventListener("DOMContentLoaded", function () {
            function loadUserData() {
                return new Promise((resolve) => {
                    let UserCreds = JSON.parse(sessionStorage.getItem("user-creds"));
                    let UserInfo = JSON.parse(sessionStorage.getItem("user-info"));

                    if (UserCreds && UserInfo) {
                        resolve({ UserCreds, UserInfo });
                    } else {
                        setTimeout(() => loadUserData().then(resolve), 100);
                    }
                });
            }

            function updateProfile() {
                loadUserData().then(({ UserCreds, UserInfo }) => {
                    let EmailHead = document.getElementById('emaildiv');
                    EmailHead.innerText = `Email: ${UserCreds.email}`;

                    let FirstNameHead = document.getElementById('firstnamediv');
                    FirstNameHead.innerText = `First Name: ${UserInfo.firstName}`;

                    let LastNameHead = document.getElementById('lastnamediv');
                    LastNameHead.innerText = `Last Name: ${UserInfo.lastName}`;
                });
            }

            // Initial update
            updateProfile();

            // Update on hash change
            window.onhashchange = updateProfile;

            function loadSavedBuilds() {
                
            }

            loadSavedBuilds(); 
        });
    </script>

</body>