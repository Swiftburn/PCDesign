<!--
 * @file Register.razor
 * @author Thomas Tran Dang (thomasdang92@gmail.com) Madelyn Little(mlittle6@atu.edu)
 * @brief This file provides the code for the register portion of the web application.
 * @version 0.2
 * @date 2023-11-29
 *
 * @copyright Copyright (c) 2023
 *
-->
@page "/register"
<PageTitle>Register</PageTitle>
<link href="css/Register.css" rel="stylesheet" />

<p>Welcome!</p>
<body>
    <!-- Note: Keep this for testing please
         <form class="reg-menu" id="regMenu">
            <form class="reg-menu" action="/account" id="regMenu">
    -->

    <form class="reg-menu" id="RegMenu">
        <input type="text" placeholder="First Name" name="fName" id="firstNameInput" required>   
        <input type="text" placeholder="Last Name" name="lName" id="lastNameInput" required><br><br>
        <input type="email" placeholder="Email" name="email" id="emailInput" required>   
        <input type="email" placeholder="Re-enter Email" name="emailRe" id="emailReInput" required><br><br>
        <input type="password" placeholder="Password" name="pswd" id="passwordInput" required>   
        <input type="password" placeholder="Re-enter Password" name="pswdRe" id="passwordReInput" required><br><br>
        <button class="btn" type="submit">Go</button><br><br>
    </form>





    <script type="module">
        //  Imported Firebase Functions
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.0/firebase-app.js";
        import { getAnalytics } from "https://www.gstatic.com/firebasejs/10.7.0/firebase-analytics.js";
        import { getFirestore, doc, setDoc } from "https://www.gstatic.com/firebasejs/10.7.0/firebase-firestore.js";
        import { getAuth, createUserWithEmailAndPassword } from "https://www.gstatic.com/firebasejs/10.7.0/firebase-auth.js";

        // Firebase Config
         const firebaseConfig = {
        apiKey: "AIzaSyBhFh8-bPKf37j_MCZaJucZ6W17OaumkuY",
        authDomain: "pcdesign-99abf.firebaseapp.com",
        projectId: "pcdesign-99abf",
        storageBucket: "pcdesign-99abf.appspot.com",
        messagingSenderId: "359736132475",
        appId: "1:359736132475:web:04c009de7e4ca4445c33de",
        measurementId: "G-RH6BHMJ91H"
        };

        // Initialize Firebase
        const app = initializeApp(firebaseConfig);
        const analytics = getAnalytics(app);
        const db = getFirestore();
        const auth = getAuth(app);

        let FirstNameInput = document.getElementById('firstNameInput');
        let LastNameInput = document.getElementById('lastNameInput');
        let EmailInput = document.getElementById('emailInput');
        let PasswordInput = document.getElementById('passwordInput');
        let RegMenu = document.getElementById('RegMenu');
        
        let RegisterUser = evt => {
            evt.preventDefault();

            createUserWithEmailAndPassword(auth, EmailInput.value, PasswordInput.value)
            .then(async (credentials)=>{
                var reference = doc(db, "UserList", credentials.user.uid);
                await setDoc(reference, {
                    firstName: FirstNameInput.value,
                    lastName: LastNameInput.value
                })

                console.log(credentials);
            })
            // Error message (just in case)
            .catch((error)=> {
                alert(error.message);
                console.log(error.code);
                console.log(error.message);
            })
        }

        RegMenu.addEventListener('submit', RegisterUser)

    </script>

</body>
